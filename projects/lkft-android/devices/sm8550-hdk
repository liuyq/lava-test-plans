{% extends "devices/sm8550-hdk" %}

{% set pre_boot_timeout = pre_boot_timeout |default(10) %}

{% set auto_login = auto_login|default(false) %}
{% set boot_method = boot_method |default("fastboot") %}
{% set BOOT_OS_PROMPT = ["console:/"] %}
{% set ptable = true %}
{% set abl = abl|default(false) %}
{% set pre_boot_command = true %}
{% set pre_os_command = false %}
{% set pre_power_command = true %}
{% set post_boot_command = false %}
{% set rootfs = false %}

{% set IMAGE_SUPPORTED_SDCARD = IMAGE_SUPPORTED_SDCARD|default(false) %}

{% set partition_super = partition_super|default(true) %}
{% set partition_userdata = partition_userdata|default(true) %}
{% if IMAGE_SUPPORTED_VENDOR_BOOT is defined and IMAGE_SUPPORTED_VENDOR_BOOT == "true" %}
    {% set partition_vendor_boot = true %}
{% endif%}

{% if TUXSUITE_BAKE_VENDOR_DOWNLOAD_URL is defined %}
{% set partition_boot_with_postprocess = false %}
{% set partition_super_with_postprocess = false %}
{% set partition_vendor_boot_with_postprocess = false %}
{% set partition_userdata_with_postprocess = false %}
{% endif%}

{% if IMAGE_SUPPORTED_SDCARD %}
    {# hack workaround for boot image specification to avoid docker mount issue #}
    {% set boot = true %}
    {% set BOOT_URL = REFERENCE_BUILD_URL + "/boot.img.xz" %}
    {% set BOOT_URL_COMP = "xz" %}
    {% set partition_boot_with_postprocess = true %}
    {# hack workaround for boot image specification end #}

    {% set ptable = false %}
    {% set partition_u_boot = true %}
    {% set U_BOOT_URL = U_BOOT_URL|default("https://testdata.linaro.org/lkft/aosp-stable/u-boot/sm8550/9abf3bedb5a1/u-boot.img") %}
    {% set U_BOOT_PROMTP_MESSAGE = U_BOOT_PROMTP_MESSAGE | default("Hit any key to stop autoboot") %}
    {% set set_active_a = true %}
{% endif%}

{% set download_postprocess_required = true %}
{% block postprocess %}
{% include "include/tuxsuite-postprocess.jinja2" %}
{% endblock postprocess %}

{% block pre_boot_command %}
{% include "include/boot_target/pre_power_command.jinja2" %}
    timeout:
          minutes: 2
{% if IMAGE_SUPPORTED_SDCARD %}
{% include PROJECT+"include/sdcard-u-boot-flash-deploy.jinja2" %}
{% endif %}
{% endblock pre_boot_command %}
